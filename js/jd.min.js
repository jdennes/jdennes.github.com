function prettyDate(epoch){var date=new Date(epoch*1000),diff=(((new Date()).getTime()-date.getTime())/1000),day_diff=Math.floor(diff/86400);if(isNaN(day_diff)||day_diff<0||day_diff>=31){return}return day_diff==0&&(diff<60&&"just now"||diff<120&&"1 minute ago"||diff<3600&&Math.floor(diff/60)+" minutes ago"||diff<7200&&"1 hour ago"||diff<86400&&Math.floor(diff/3600)+" hours ago")||day_diff==1&&"Yesterday"||day_diff<7&&day_diff+" days ago"||day_diff<31&&Math.ceil(day_diff/7)+" weeks ago"}(function($){$.fn.flickr=function(options){var defaults={number:10,id:"99761031@N00",lang:"en-us",onComplete:function(){}},settings=$.extend({},defaults,options);var url="http://api.flickr.com/services/feeds/photos_public.gne?id="+settings.id+"&lang="+settings.lang+"&format=json&jsoncallback=?";var $this=$(this);var container=$this.html();$this.children(":first").remove();this.each(function(){$("#snapping").empty();var i=0;$.getJSON(url,function(data){$.each(data.items,function(i,item){if(i<settings.number){$("<img/>").attr({src:item.media.m.replace("_m.jpg","_s.jpg"),alt:item.title,width:"50",height:"50"}).appendTo("#snapping").wrap('<a href="'+item.link+'" title="'+item.title+'" target="_blank"></a>')}i++})})})}})(jQuery);if(typeof renderTwitters!="function"){(function(){var j=(function(){var b=navigator.userAgent.toLowerCase();return{webkit:/(webkit|khtml)/.test(b),opera:/opera/.test(b),msie:/msie/.test(b)&&!(/opera/).test(b),mozilla:/mozilla/.test(b)&&!(/(compatible|webkit)/).test(b)}})();var k=0;var n=[];var o=false;var p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];window.ify=function(){var c={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"};return{link:function(t){return t.replace(/[a-z]+:\/\/[a-z0-9-_]+\.[a-z0-9-_:~%&\?\/.=]+[^:\.,\)\s*$]/ig,function(m){return'<a href="'+m+'">'+((m.length>25)?m.substr(0,24)+"...":m)+"</a>"})},at:function(t){return t.replace(/(^|[^\w]+)\@([a-zA-Z0-9_]{1,15})/g,function(m,a,b){return a+'@<a href="http://twitter.com/'+b+'">'+b+"</a>"})},hash:function(t){return t.replace(/(^|[^\w'"]+)\#([a-zA-Z0-9_]+)/g,function(m,a,b){return a+'#<a href="http://search.twitter.com/search?q=%23'+b+'">'+b+"</a>"})},clean:function(a){return this.hash(this.at(this.link(a)))}}}();window.renderTwitters=function(a,b){function node(e){return document.createElement(e)}function text(t){return document.createTextNode(t)}var c=document.getElementById(b.twitterTarget);var d=null;var f=node("ul"),li,statusSpan,timeSpan,i,max=a.length>b.count?b.count:a.length;for(i=0;i<max&&a[i];i++){d=getTwitterData(a[i]);if(b.ignoreReplies&&a[i].text.substr(0,1)=="@"){max++;continue}li=node("li");if(b.template){li.innerHTML=b.template.replace(/%([a-z_\-\.]*)%/ig,function(m,l){var r=d[l]+""||"";if(l=="text"&&b.enableLinks){r=ify.clean(r)}return r})}else{statusSpan=node("span");statusSpan.className="twitterStatus";timeSpan=node("span");timeSpan.className="twitterTime";statusSpan.innerHTML=a[i].text;if(b.enableLinks==true){statusSpan.innerHTML=ify.clean(statusSpan.innerHTML)}timeSpan.innerHTML=relative_time(a[i].created_at);if(b.prefix){var s=node("span");s.className="twitterPrefix";s.innerHTML=b.prefix.replace(/%(.*?)%/g,function(m,l){return a[i].user[l]});li.appendChild(s);li.appendChild(text(" "))}li.appendChild(statusSpan);li.appendChild(text(" "));li.appendChild(timeSpan)}if(b.newwindow){li.innerHTML=li.innerHTML.replace(/<a href/gi,'<a target="_blank" href')}f.appendChild(li)}if(b.clearContents){while(c.firstChild){c.removeChild(c.firstChild)}}c.appendChild(f);if(typeof b.callback=="function"){b.callback()}};window.getTwitters=function(e,f,g,h){k++;if(typeof f=="object"){h=f;f=h.id;g=h.count}if(!g){g=1}if(h){h.count=g}else{h={}}if(!h.timeout&&typeof h.onTimeout=="function"){h.timeout=10}if(typeof h.clearContents=="undefined"){h.clearContents=true}if(h.withFriends){h.withFriends=false}h.twitterTarget=e;if(typeof h.enableLinks=="undefined"){h.enableLinks=true}window["twitterCallback"+k]=function(a){if(h.timeout){clearTimeout(window["twitterTimeout"+k])}renderTwitters(a,h)};ready((function(c,d){return function(){if(!document.getElementById(c.twitterTarget)){return}var a="http://www.twitter.com/statuses/"+(c.withFriends?"friends_timeline":"user_timeline")+"/"+f+".json?callback=twitterCallback"+d+"&count=20&cb="+Math.random();if(c.timeout){window["twitterTimeout"+d]=setTimeout(function(){if(c.onTimeoutCancel){window["twitterCallback"+d]=function(){}}c.onTimeout.call(document.getElementById(c.twitterTarget))},c.timeout*1000)}var b=document.createElement("script");b.setAttribute("src",a);document.getElementsByTagName("head")[0].appendChild(b)}})(h,k))};DOMReady();function getTwitterData(a){var b=a,i;for(i in a.user){b["user_"+i]=a.user[i]}b.time=relative_time(a.created_at);return b}function ready(a){if(!o){n.push(a)}else{a.call()}}function fireReady(){o=true;var a;while(a=n.shift()){a.call()}}function DOMReady(){if(document.addEventListener&&!j.webkit){document.addEventListener("DOMContentLoaded",fireReady,false)}else{if(j.msie){document.write("<script id=__ie_init defer=true src=//:><\/script>");var a=document.getElementById("__ie_init");if(a){a.onreadystatechange=function(){if(this.readyState!="complete"){return}this.parentNode.removeChild(this);fireReady.call()}}a=null}else{if(j.webkit){var b=setInterval(function(){if(document.readyState=="loaded"||document.readyState=="complete"){clearInterval(b);b=null;fireReady.call()}},10)}}}}function relative_time(c){var d=c.split(" "),parsed_date=Date.parse(d[1]+" "+d[2]+", "+d[5]+" "+d[3]),date=new Date(parsed_date),relative_to=(arguments.length>1)?arguments[1]:new Date(),delta=parseInt((relative_to.getTime()-parsed_date)/1000),r="";function formatTime(a){var b=a.getHours(),min=a.getMinutes()+"",ampm="AM";if(b==0){b=12}else{if(b==12){ampm="PM"}else{if(b>12){b-=12;ampm="PM"}}}if(min.length==1){min="0"+min}return b+":"+min+" "+ampm}function formatDate(a){var b=a.toDateString().split(/ /),mon=p[a.getMonth()],day=a.getDate()+"",dayi=parseInt(day),year=a.getFullYear(),thisyear=(new Date()).getFullYear(),th="th";if((dayi%10)==1&&day.substr(0,1)!="1"){th="st"}else{if((dayi%10)==2&&day.substr(0,1)!="1"){th="nd"}else{if((dayi%10)==3&&day.substr(0,1)!="1"){th="rd"}}}if(day.substr(0,1)=="0"){day=day.substr(1)}return mon+" "+day+th+(thisyear!=year?", "+year:"")}delta=delta+(relative_to.getTimezoneOffset()*60);if(delta<5){r="less than 5 seconds ago"}else{if(delta<30){r="half a minute ago"}else{if(delta<60){r="less than a minute ago"}else{if(delta<120){r="1 minute ago"}else{if(delta<(45*60)){r=(parseInt(delta/60)).toString()+" minutes ago"}else{if(delta<(2*90*60)){r="about 1 hour ago"}else{if(delta<(24*60*60)){r="about "+(parseInt(delta/3600)).toString()+" hours ago"}else{if(delta<(48*60*60)){r=formatTime(date)+" yesterday"}else{r=formatTime(date)+" "+formatDate(date)}}}}}}}}return r}})()}(function($){$.fn.lastFM=function(options){var defaults={number:8,username:"jdennes",apikey:"3ab5290b3f5973475ef258a41323fdad",artSize:"small",noart:"http://cdn.last.fm/flatness/catalogue/noimage/2/default_artist_small.png",onComplete:function(){}},settings=$.extend({},defaults,options);var lastUrl="http://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user="+settings.username+"&api_key="+settings.apikey+"&limit="+settings.number+"&format=json&callback=?";var $this=$(this);var container=$this.html();$this.children(":first").remove();if(settings.artSize=="small"){imgSize=0}if(settings.artSize=="medium"){imgSize=1}if(settings.artSize=="large"){imgSize=2}this.each(function(){$.getJSON(lastUrl,function(data){$.each(data.recenttracks.track,function(i,item){if(item.image[1]["#text"]==""){art=settings.noart}else{art=stripslashes(item.image[imgSize]["#text"])}url=stripslashes(item.url);song=item.name;artist=item.artist["#text"];album=item.album["#text"];time="";if(item.date){time=item.date.uts}now_playing="";if(item.hasOwnProperty("@attr")){now_playing=item["@attr"]["nowplaying"]}$this.append(container);var $current=$this.children(":eq("+i+")");when=prettyDate(time);$current.find("[class=lfm_song]").append(song);$current.find("[class=lfm_artist]").append(artist);$current.find("[class=lfm_art]").append("<img src='"+art+"' alt='Artwork for "+album+"'/>");$current.find("[class=lfm_time]").append((now_playing=="true"?'<img width="12" height="12" src="http://cdn.last.fm/flatness/global/icon_eq.gif" alt="Now playing" /> ':"")+(when==undefined&&now_playing=="true"?"Now playing":when));$current.find("a").attr("href",url).attr("title",song+" on Last.fm").attr("target","_blank");if(i==(settings.number-1)){settings.onComplete.call(this)}})})})};function stripslashes(str){return(str+"").replace(/\0/g,"0").replace(/\\([\\'"])/g,"$1")}})(jQuery);function gReaderSeed(data){var html=[];html.push("<ul>");var is=data.items;for(var i=0,j=is.length;i<j;i++){html.push("<li>");var pd=new Date(is[i].published*1000);html.push('<a class="item-title" href="'+is[i].alternate.href+'">'+is[i].title+'</a><br /><span class="item-details">'+(is[i].author==undefined?"":"by "+is[i].author+" ")+'via <a href="'+is[i].origin.htmlUrl+'">'+is[i].origin.title+"</a> ("+pd.getDate()+"/"+(pd.getMonth()+1)+"/"+pd.getFullYear()+")</span>");html.push("</li>")}html.push("</ul>");$("div#reading-shared-items").html(html.join(""))}function gReaderInit(numItems,userId){var url="http://www.google.com/reader/public/javascript/user/"+userId+"/state/com.google/broadcast?n="+numItems+"&callback=?";$.getJSON(url,gReaderSeed)}function githubActivitySeed(data){var html=[];html.push("<ul>");var is=data.value.items;for(var i=0;i<6;i++){html.push("<li>");html.push('<a href="'+is[i].link+'">'+prettyDate(parseInt(is[i]["y:published"].utime)+28800)+" "+is[i].title+'</a><div class="item-details">'+is[i].content.content+"</div>");html.push("</li>")}html.push("</ul>");$("div#github-activity").html(html.join(""))}function loadGithubActivity(){var activity_url="http://pipes.yahoo.com/pipes/pipe.run?_id=a6bc41631b551cf342113be8c733a329&_render=json&_callback=?";$.getJSON(activity_url,githubActivitySeed)}function tick(){var age=(new Date().getTime()-new Date().setTime(453900600000))/31536000000;$("span#age").html(age.toFixed(8))}function loadSnapping(){$("img#snapping-loading").show();$("div#snapping").hide();$("div#snapping").flickr({id:"99761031@N00",number:16,lang:"en-us",onComplete:function(){}});$("div#snapping").show();$("img#snapping-loading").hide()}function loadTweeting(){$("img#tweeting-loading").show();$("div#tweets").hide();getTwitters("tweets",{id:"jdennes",count:8,enableLinks:true,ignoreReplies:true,clearContents:true,template:'"%text%" <a class="when" href="http://twitter.com/%user_screen_name%/statuses/%id%/"><br />%time%</a>'});$("div#tweets").show();$("img#tweeting-loading").hide()}function loadListening(){$("img#listening-loading").show();$("div#lastfm").hide();$("div#lastfm").html('<dl><dt class="lfm_art"><a href="#"></a></dt><dd class="lfm_song"></dd><dd class="lfm_artist"></dd><dd class="lfm_time"></dd></dl>');$("div#lastfm").lastFM({username:"jdennes",apikey:"3ab5290b3f5973475ef258a41323fdad",number:9,artSize:"small",noart:"http://cdn.last.fm/flatness/catalogue/noimage/2/default_artist_small.png",onComplete:function(){}});$("div#lastfm").show();$("img#listening-loading").hide()}function loadReading(){$("img#reading-loading").show();$("div#reading-shared-items").hide();gReaderInit(6,"10795563111833728553");$("div#reading-shared-items").show();$("img#reading-loading").hide()}function loadCoding(){$("img#coding-loading").show();$("div#github-activity").hide();loadGithubActivity();$("div#github-activity").show();$("img#coding-loading").hide()}$(document).ready(function(){setInterval("tick()",1000);loadSnapping();loadTweeting();loadListening();loadReading();loadCoding()});